import peripherals
import oled
import gps
import pwm
import stations
from specific import Location
import leds

selected_coordinate = 0
test_coordinate = [
    Location(46.301905, 16.321384, 0, 10),
    Location(46.301821, 16.32145, 0, 10),
    Location(46.302262, 16.32251, 0, 10),
    Location(46.30255, 16.323146, 0, 10),
    Location(46.302736, 16.323438, 0, 10),
    Location(46.303056, 16.323866, 0, 10),
    Location(46.303287, 16.324158, 0, 10),
    Location(46.303567, 16.324434, 0, 10),
    Location(46.303818, 16.324805, 0, 10),
    Location(46.304279, 16.325981, 0, 10),
    Location(46.30461, 16.326744, 0, 10),
    Location(46.304588, 16.32681, 0, 10),
    Location(46.304596, 16.326883, 0, 10),
    Location(46.30463, 16.326937, 0, 10),
    Location(46.30468, 16.326955, 0, 10),
    Location(46.304748, 16.327387, 0, 10),
    Location(46.304929, 16.328296, 0, 10),
    Location(46.305335, 16.330239, 0, 10),
    Location(46.305464, 16.330704, 0, 10),
    Location(46.306178, 16.332769, 0, 10),
    Location(46.30653, 16.333833, 0, 10),
    Location(46.304881, 16.334486, 0, 10),
    Location(46.305208, 16.336117, 0, 10),
    Location(46.3056, 16.338038, 0, 10),
    Location(46.306038, 16.340417, 0, 10),
    Location(46.306053, 16.340497, 0, 10),
    Location(46.306122, 16.340814, 0, 10),
    Location(46.306195, 16.340985, 0, 10),
    Location(46.306312, 16.341148, 0, 10),
    Location(46.306388, 16.341203, 0, 10),
    Location(46.30656, 16.341242, 0, 10),
    Location(46.307273, 16.341034, 0, 10),
    Location(46.307937, 16.340874, 0, 10),
    Location(46.308881, 16.340489, 0, 10),
    Location(46.309594, 16.340245, 0, 10),
    Location(46.309676, 16.340375, 0, 10),
    Location(46.310377, 16.342717, 0, 10),
    Location(46.310728, 16.343796, 0, 10),
    Location(46.310907, 16.344447, 0, 10),
    Location(46.311358, 16.345625, 0, 10),
    Location(46.312157, 16.347494, 0, 10),
    Location(46.312379, 16.348162, 0, 10),
    Location(46.312541, 16.348505, 0, 10),
    Location(46.312673, 16.348716, 0, 10),
    Location(46.313397, 16.349714, 0, 10),
    Location(46.313902, 16.35037, 0, 10),
    Location(46.314523, 16.351134, 0, 10),
    Location(46.314693, 16.351318, 0, 10),
    Location(46.316791, 16.353986, 0, 10),
    Location(46.31709, 16.35431, 0, 10),
    Location(46.317299, 16.354498, 0, 10),
    Location(46.319381, 16.356153, 0, 10),
    Location(46.319679, 16.356284, 0, 10),
    Location(46.320931, 16.357264, 0, 10),
    Location(46.323129, 16.358661, 0, 10),
    Location(46.323348, 16.358792, 0, 10),
    Location(46.323634, 16.358907, 0, 10),
    Location(46.324637, 16.359118, 0, 10),
    Location(46.330852, 16.360147, 0, 10),
    Location(46.333339, 16.360536, 0, 10),
    Location(46.341742, 16.361962, 0, 10),
    Location(46.343688, 16.362249, 0, 10),
    Location(46.343973, 16.362233, 0, 10),
    Location(46.34422, 16.362178, 0, 10),
    Location(46.345693, 16.361682, 0, 10),
    Location(46.345973, 16.361566, 0, 10),
    Location(46.346552, 16.361455, 0, 10),
    Location(46.347009, 16.361409, 0, 10),
    Location(46.347608, 16.361486, 0, 10),
    Location(46.347856, 16.361538, 0, 10),
    Location(46.348085, 16.361617, 0, 10),
    Location(46.348325, 16.361732, 0, 10),
    Location(46.348612, 16.361915, 0, 10),
    Location(46.349349, 16.362445, 0, 10),
    Location(46.34973, 16.362659, 0, 10),
    Location(46.349967, 16.362743, 0, 10),
    Location(46.350851, 16.362958, 0, 10),
    Location(46.351409, 16.363182, 0, 10),
    Location(46.351913, 16.363504, 0, 10),
    Location(46.354138, 16.365185, 0, 10),
    Location(46.354645, 16.365551, 0, 10),
    Location(46.35507, 16.365792, 0, 10),
    Location(46.35606, 16.366258, 0, 10),
    Location(46.357823, 16.367206, 0, 10),
    Location(46.361759, 16.369029, 0, 10),
    Location(46.362212, 16.369204, 0, 10),
    Location(46.363624, 16.369658, 0, 10),
    Location(46.365148, 16.3701, 0, 10),
    Location(46.365513, 16.370244, 0, 10),
    Location(46.365825, 16.370418, 0, 10),
    Location(46.366077, 16.370603, 0, 10),
    Location(46.366517, 16.371029, 0, 10),
    Location(46.367554, 16.372384, 0, 10),
    Location(46.368043, 16.3729, 0, 10),
    Location(46.369052, 16.373892, 0, 10),
    Location(46.370274, 16.375204, 0, 10),
    Location(46.370654, 16.375582, 0, 10),
    Location(46.37112, 16.375979, 0, 10),
    Location(46.372173, 16.376777, 0, 10),
    Location(46.374736, 16.378363, 0, 10),
    Location(46.375506, 16.378881, 0, 10),
    Location(46.375909, 16.379261, 0, 10),
    Location(46.376232, 16.379716, 0, 10),
    Location(46.376368, 16.379957, 0, 10),
    Location(46.376419, 16.380073, 0, 10),
    Location(46.376653, 16.380913, 0, 10),
    Location(46.376689, 16.381092, 0, 10),
    Location(46.376753, 16.381576, 0, 10),
    Location(46.376784, 16.382119, 0, 10),
    Location(46.37676, 16.382903, 0, 10),
    Location(46.376704, 16.383878, 0, 10),
    Location(46.376619, 16.384419, 0, 10),
    Location(46.376526, 16.384762, 0, 10),
    Location(46.376414, 16.385037, 0, 10),
    Location(46.375957, 16.386298, 0, 10),
    Location(46.375811, 16.38687, 0, 10),
    Location(46.375777, 16.387345, 0, 10),
    Location(46.375811, 16.387759, 0, 10),
    Location(46.375861, 16.388013, 0, 10),
    Location(46.376091, 16.388709, 0, 10),
    Location(46.376357, 16.389393, 0, 10),
    Location(46.376575, 16.389812, 0, 10),
    Location(46.376777, 16.39008, 0, 10),
    Location(46.377897, 16.391274, 0, 10),
    Location(46.378031, 16.391456, 0, 10),
    Location(46.37814, 16.391641, 0, 10),
    Location(46.378254, 16.391858, 0, 10),
    Location(46.378364, 16.392141, 0, 10),
    Location(46.378499, 16.39268, 0, 10),
    Location(46.378604, 16.393253, 0, 10),
    Location(46.37926, 16.397012, 0, 10),
    Location(46.379717, 16.399897, 0, 10),
    Location(46.379805, 16.40028, 0, 10),
    Location(46.379886, 16.400521, 0, 10),
    Location(46.379946, 16.400224, 0, 10),
    Location(46.38004, 16.400047, 0, 10),
    Location(46.380075, 16.400004, 0, 10),
]

def on_button_callback(state):
    print("button %s" % (("released", "pressed")[state]))
    if state:
        global selected_coordinate
        selected_coordinate += 1
        if selected_coordinate == len(test_coordinate):
            selected_coordinate = 0
        gps.set_location(test_coordinate[selected_coordinate])


if __name__ == "__main__":
    peripherals.register_button_callback_function(on_button_callback)
    pwm.init()
    oled.init()
    leds.init()
    gps.init()

    while True:
        peripherals.loop()
        gps.loop()
        pwm.loop()
        leds.loop()
        stations.loop()
